"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1926],{744:(e,r,t)=>{t.d(r,{A:()=>h});var s=t(5155),a=t(2115),l=t(5229),i=t(6651),n=t(5299),o=t(1786),c=t(5917),d=t(5239);function h(e){let{isOpen:r,onClose:t,onSelect:h}=e,[g,x]=(0,a.useState)([]),[u,m]=(0,a.useState)(!1),[p,b]=(0,a.useState)(!1),[f,j]=(0,a.useState)(""),[y,v]=(0,a.useState)(null);(0,a.useEffect)(()=>{r&&N()},[r]);let N=async()=>{m(!0);try{let e=new URLSearchParams({page:"1",limit:"48",mimeType:"image"});f&&e.append("search",f);let r=await fetch("/api/admin/media?".concat(e)),t=await r.json();t.media&&x(t.media)}catch(e){console.error("Failed to fetch media:",e)}finally{m(!1)}};(0,a.useEffect)(()=>{let e=setTimeout(()=>{r&&N()},300);return()=>clearTimeout(e)},[f,r]);let w=async e=>{let r=e.target.files;if(r&&0!==r.length){b(!0);try{for(let e of Array.from(r)){let r=new FormData;r.append("file",e),r.append("folder","blog");let t=await fetch("/api/admin/media/upload/",{method:"POST",body:r}),s=await t.json();s.success||alert("Hiba a f\xe1jl felt\xf6lt\xe9sekor: ".concat(e.name,"\n").concat(s.error))}await N(),e.target.value=""}catch(e){console.error("Upload failed:",e),alert("Hiba t\xf6rt\xe9nt a felt\xf6lt\xe9s sor\xe1n")}finally{b(!1)}}};return r?(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",onClick:t,children:(0,s.jsxs)("div",{className:"relative w-full max-w-4xl max-h-[85vh] bg-white rounded-lg overflow-hidden flex flex-col",onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"K\xe9p kiv\xe1laszt\xe1sa"}),(0,s.jsx)("button",{type:"button",onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,s.jsx)(l.A,{className:"w-5 h-5"})})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4 p-4 border-b border-gray-200 bg-gray-50",children:[(0,s.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,s.jsx)(i.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,s.jsx)("input",{type:"text",value:f,onChange:e=>j(e.target.value),placeholder:"Keres\xe9s...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"})]}),(0,s.jsxs)("label",{className:"relative cursor-pointer",children:[(0,s.jsx)("input",{type:"file",accept:"image/*",multiple:!0,onChange:w,disabled:p,className:"hidden"}),(0,s.jsx)("span",{className:"flex items-center gap-2 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 disabled:opacity-50 transition-colors font-medium",children:p?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.A,{className:"w-4 h-4 animate-spin"}),"Felt\xf6lt\xe9s..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.A,{className:"w-4 h-4"}),"Felt\xf6lt\xe9s"]})})]})]}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto p-4",children:u?(0,s.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,s.jsx)(n.A,{className:"w-8 h-8 animate-spin text-orange-600"})}):0===g.length?(0,s.jsx)("div",{className:"text-center py-12",children:(0,s.jsx)("p",{className:"text-gray-500",children:"Nincs tal\xe1lat"})}):(0,s.jsx)("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 gap-3",children:g.map(e=>(0,s.jsxs)("button",{type:"button",onClick:()=>v(e),className:"relative aspect-square rounded-lg overflow-hidden border-2 transition-all ".concat((null==y?void 0:y.id)===e.id?"border-orange-500 ring-2 ring-orange-500/20":"border-transparent hover:border-gray-300"),children:[(0,s.jsx)(d.default,{src:"/".concat(e.thumbnailPath||e.path),alt:e.alt||e.originalName,fill:!0,className:"object-cover",sizes:"(max-width: 640px) 33vw, (max-width: 768px) 25vw, 16vw"}),(null==y?void 0:y.id)===e.id&&(0,s.jsx)("div",{className:"absolute inset-0 bg-orange-500/20 flex items-center justify-center",children:(0,s.jsx)("div",{className:"w-8 h-8 rounded-full bg-orange-500 flex items-center justify-center",children:(0,s.jsx)(c.A,{className:"w-5 h-5 text-white"})})})]},e.id))})}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border-t border-gray-200 bg-gray-50",children:[y?(0,s.jsxs)("div",{className:"flex items-center gap-3 text-sm text-gray-600",children:[(0,s.jsx)("span",{className:"font-medium",children:y.originalName}),(0,s.jsx)("span",{className:"text-gray-400",children:"|"}),(0,s.jsx)("span",{children:function(e){if(0===e)return"0 B";let r=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,r)).toFixed(2))+" "+["B","KB","MB","GB"][r]}(y.size)}),y.width&&y.height&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"text-gray-400",children:"|"}),(0,s.jsxs)("span",{children:[y.width," \xd7 ",y.height]})]})]}):(0,s.jsx)("div",{className:"text-sm text-gray-500",children:"V\xe1lassz ki egy k\xe9pet"}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("button",{type:"button",onClick:t,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"M\xe9gse"}),(0,s.jsx)("button",{type:"button",onClick:()=>{y&&h(y.path.startsWith("/")?y.path:"/".concat(y.path))},disabled:!y,className:"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:"Kiv\xe1laszt\xe1s"})]})]})]})}):null}},5713:(e,r,t)=>{t.d(r,{A:()=>w});var s=t(5155),a=t(154),l=t(3143),i=t(6135),n=t(3660),o=t(2115),c=t(7048),d=t(4615),h=t(5833),g=t(7456),x=t(355),u=t(3),m=t(7239),p=t(859),b=t(924),f=t(2196),j=t(6980),y=t.n(j);function v(e){let{onClick:r,isActive:t=!1,disabled:a=!1,title:l,children:i}=e;return(0,s.jsx)("button",{type:"button",onClick:r,disabled:a,title:l,className:"p-2 rounded transition-colors ".concat(t?"bg-orange-100 text-orange-600":"hover:bg-gray-100 text-gray-600"," ").concat(a?"opacity-50 cursor-not-allowed":""),children:i})}function N(){return(0,s.jsx)("div",{className:"w-px h-6 bg-gray-300 mx-1"})}function w(e){var r,t,j;let{content:w,onChange:_,placeholder:k="Kezdj el \xedrni...",minHeight:A="200px",onImageInsert:C,showImageButton:M=!0}=e,[P,L]=(0,o.useState)(!1),[F,z]=(0,o.useState)(""),T=(0,a.hG)({immediatelyRender:!1,extensions:[l.A.configure({heading:{levels:[1,2,3]}}),i.Ay.configure({openOnClick:!1,HTMLAttributes:{class:"text-orange-600 underline hover:text-orange-700"}}),n.Ay.configure({HTMLAttributes:{class:"max-w-full h-auto rounded-lg my-4"}})],content:w,editorProps:{attributes:{class:"prose prose-sm max-w-none focus:outline-none",style:"min-height: ".concat(A)}},onUpdate:e=>{let{editor:r}=e,t=r.getHTML();_(y().sanitize(t,{ALLOWED_TAGS:["p","br","strong","em","u","h1","h2","h3","ul","ol","li","a","img","blockquote"],ALLOWED_ATTR:["href","target","rel","src","alt","class"]}))}}),S=(0,o.useCallback)(()=>{T&&(F&&T.chain().focus().extendMarkRange("link").setLink({href:F,target:"_blank"}).run(),z(""),L(!1))},[T,F]),E=(0,o.useCallback)(()=>{T&&T.chain().focus().unsetLink().run()},[T]),B=(0,o.useCallback)(e=>{T&&T.chain().focus().setImage({src:e}).run()},[T]);return(T&&(window.__richTextInsertImage=B),T)?(0,s.jsxs)("div",{className:"border border-gray-300 rounded-lg overflow-hidden",children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-1 p-2 border-b border-gray-300 bg-gray-50",children:[(0,s.jsx)(v,{onClick:()=>T.chain().focus().toggleBold().run(),isActive:T.isActive("bold"),title:"F\xe9lk\xf6v\xe9r (Ctrl+B)",children:(0,s.jsx)(c.A,{className:"w-4 h-4"})}),(0,s.jsx)(v,{onClick:()=>T.chain().focus().toggleItalic().run(),isActive:T.isActive("italic"),title:"DÅ‘lt (Ctrl+I)",children:(0,s.jsx)(d.A,{className:"w-4 h-4"})}),(0,s.jsx)(N,{}),(0,s.jsx)(v,{onClick:()=>T.chain().focus().toggleHeading({level:1}).run(),isActive:T.isActive("heading",{level:1}),title:"C\xedmsor 1",children:(0,s.jsx)(h.A,{className:"w-4 h-4"})}),(0,s.jsx)(v,{onClick:()=>T.chain().focus().toggleHeading({level:2}).run(),isActive:T.isActive("heading",{level:2}),title:"C\xedmsor 2",children:(0,s.jsx)(g.A,{className:"w-4 h-4"})}),(0,s.jsx)(v,{onClick:()=>T.chain().focus().toggleHeading({level:3}).run(),isActive:T.isActive("heading",{level:3}),title:"C\xedmsor 3",children:(0,s.jsx)(x.A,{className:"w-4 h-4"})}),(0,s.jsx)(N,{}),(0,s.jsx)(v,{onClick:()=>T.chain().focus().toggleBulletList().run(),isActive:T.isActive("bulletList"),title:"Felsorol\xe1s",children:(0,s.jsx)(u.A,{className:"w-4 h-4"})}),(0,s.jsx)(v,{onClick:()=>T.chain().focus().toggleOrderedList().run(),isActive:T.isActive("orderedList"),title:"Sz\xe1moz\xe1s",children:(0,s.jsx)(m.A,{className:"w-4 h-4"})}),(0,s.jsx)(N,{}),P?(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{type:"url",value:F,onChange:e=>z(e.target.value),placeholder:"https://...",className:"px-2 py-1 border border-gray-300 rounded text-sm w-48 focus:ring-2 focus:ring-orange-500 focus:border-transparent",onKeyDown:e=>{"Enter"===e.key?(e.preventDefault(),S()):"Escape"===e.key&&(L(!1),z(""))},autoFocus:!0}),(0,s.jsx)("button",{type:"button",onClick:S,className:"px-2 py-1 bg-orange-500 text-white rounded text-sm hover:bg-orange-600 transition-colors",children:"OK"}),(0,s.jsx)("button",{type:"button",onClick:()=>{L(!1),z("")},className:"px-2 py-1 bg-gray-200 text-gray-600 rounded text-sm hover:bg-gray-300 transition-colors",children:"M\xe9gse"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(v,{onClick:()=>{z(T.getAttributes("link").href||""),L(!0)},isActive:T.isActive("link"),title:"Link besz\xfar\xe1s",children:(0,s.jsx)(p.A,{className:"w-4 h-4"})}),T.isActive("link")&&(0,s.jsx)(v,{onClick:E,title:"Link t\xf6rl\xe9se",children:(0,s.jsx)(b.A,{className:"w-4 h-4"})})]}),M&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(N,{}),(0,s.jsx)(v,{onClick:()=>null==C?void 0:C(),title:"K\xe9p besz\xfar\xe1s",children:(0,s.jsx)(f.A,{className:"w-4 h-4"})})]})]}),(0,s.jsxs)("div",{className:"p-4 bg-white",children:[(0,s.jsx)(a.$Z,{editor:T,className:"[&_.ProseMirror]:outline-none [&_.ProseMirror]:text-gray-900 [&_.ProseMirror]:min-h-[200px] [&_.ProseMirror_p]:mb-2 [&_.ProseMirror_h1]:text-2xl [&_.ProseMirror_h1]:font-bold [&_.ProseMirror_h1]:mb-4 [&_.ProseMirror_h1]:text-gray-900 [&_.ProseMirror_h2]:text-xl [&_.ProseMirror_h2]:font-semibold [&_.ProseMirror_h2]:mb-3 [&_.ProseMirror_h2]:text-gray-900 [&_.ProseMirror_h3]:text-lg [&_.ProseMirror_h3]:font-semibold [&_.ProseMirror_h3]:mb-2 [&_.ProseMirror_h3]:text-gray-900 [&_.ProseMirror_ul]:list-disc [&_.ProseMirror_ul]:pl-5 [&_.ProseMirror_ul]:mb-2 [&_.ProseMirror_ol]:list-decimal [&_.ProseMirror_ol]:pl-5 [&_.ProseMirror_ol]:mb-2 [&_.ProseMirror_li]:mb-1"}),T.isEmpty&&(0,s.jsx)("p",{className:"text-gray-400 pointer-events-none absolute top-4 left-4",children:k})]}),(0,s.jsxs)("div",{className:"px-4 py-2 border-t border-gray-200 bg-gray-50 text-right text-xs text-gray-500",children:[null!=(j=null==(t=T.storage.characterCount)||null==(r=t.characters)?void 0:r.call(t))?j:T.getText().length," karakter"]})]}):(0,s.jsxs)("div",{className:"border border-gray-300 rounded-lg p-4 min-h-[200px] animate-pulse bg-gray-50",children:[(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-2"}),(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4"})]})}}}]);