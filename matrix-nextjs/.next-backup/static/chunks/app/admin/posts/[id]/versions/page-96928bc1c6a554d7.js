(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1976],{6064:(e,s,t)=>{Promise.resolve().then(t.bind(t,9470)),Promise.resolve().then(t.t.bind(t,2619,23))},9470:(e,s,t)=>{"use strict";t.d(s,{default:()=>n});var a=t(5155),l=t(2115),r=t(4393),i=t(8657);function n(e){let{postId:s,onRestore:t}=e,[n,c]=(0,l.useState)([]),[d,o]=(0,l.useState)(null),[m,x]=(0,l.useState)(null),[h,g]=(0,l.useState)([]),[u,p]=(0,l.useState)(!0),[b,v]=(0,l.useState)(null),[y,j]=(0,l.useState)(!1),[N,f]=(0,l.useState)(!1);(0,l.useEffect)(()=>{w()},[s]);let w=async()=>{p(!0),v(null);try{let e=await fetch("/api/admin/posts/".concat(s,"/versions"));if(!e.ok)throw Error("Hiba a verzi\xf3k bet\xf6lt\xe9sekor");let t=await e.json();c(t)}catch(e){v(e instanceof Error?e.message:"Ismeretlen hiba")}finally{p(!1)}},k=async e=>{if(confirm("Biztosan vissza\xe1ll\xedtja a ".concat(e,". verzi\xf3t?\n\nA jelenlegi \xe1llapot biztons\xe1gi ment\xe9sre ker\xfcl."))){j(!0),v(null);try{let a=await fetch("/api/admin/posts/".concat(s,"/versions"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({versionNum:e})});if(!a.ok){let e=await a.json();throw Error(e.error||"Hiba a vissza\xe1ll\xedt\xe1skor")}alert("A ".concat(e,". verzi\xf3 sikeresen vissza\xe1ll\xedtva!")),await w(),o(null),null==t||t()}catch(e){v(e instanceof Error?e.message:"Ismeretlen hiba")}finally{j(!1)}}},z=async e=>{f(!0),v(null);try{let t=await fetch("/api/admin/posts/".concat(s,"/versions?compare=").concat(e.versionNum));if(!t.ok)throw Error("Hiba az \xf6sszehasonl\xedt\xe1skor");let a=await t.json();g(a.diffs),x(e)}catch(e){v(e instanceof Error?e.message:"Ismeretlen hiba")}finally{f(!1)}},E=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,t=e.replace(/<[^>]*>/g," ").replace(/\s+/g," ").trim();return t.length>s?t.substring(0,s)+"...":t};return u?(0,a.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,a.jsx)("span",{className:"ml-3 text-gray-600",children:"Verzi\xf3k bet\xf6lt\xe9se..."})]}):b?(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:[(0,a.jsx)("p",{className:"font-bold",children:"Hiba"}),(0,a.jsx)("p",{children:b})]}):0===n.length?(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,a.jsx)("p",{className:"text-lg",children:"M\xe9g nincsenek mentett verzi\xf3k"}),(0,a.jsx)("p",{className:"text-sm mt-2",children:"A verzi\xf3k automatikusan ment\xe9sre ker\xfclnek a poszt m\xf3dos\xedt\xe1sakor"})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:["Verzi\xf3előzm\xe9nyek (",n.length,")"]})}),(0,a.jsx)("div",{className:"divide-y divide-gray-200",children:n.map(e=>(0,a.jsxs)("div",{className:"px-6 py-4 hover:bg-gray-50 transition-colors ".concat((null==d?void 0:d.id)===e.id?"bg-blue-50":""),children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:["v",e.versionNum]}),(0,a.jsx)("span",{className:"text-sm text-gray-600",children:(0,r.GP)(new Date(e.createdAt),"yyyy. MMMM d. HH:mm",{locale:i.hu})}),(0,a.jsx)("span",{className:"text-sm text-gray-500",children:e.createdByName||"Ismeretlen"})]}),e.changeNote&&(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-700",children:e.changeNote}),(0,a.jsx)("p",{className:"mt-2 text-sm font-medium text-gray-900 truncate",children:e.title})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 ml-4",children:[(0,a.jsx)("button",{onClick:()=>o((null==d?void 0:d.id)===e.id?null:e),className:"px-3 py-1 text-sm text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded transition-colors",children:(null==d?void 0:d.id)===e.id?"Bez\xe1r\xe1s":"Előn\xe9zet"}),(0,a.jsx)("button",{onClick:()=>z(e),disabled:N,className:"px-3 py-1 text-sm text-gray-600 hover:text-gray-700 hover:bg-gray-100 rounded transition-colors disabled:opacity-50",children:"\xd6sszehasonl\xedt\xe1s"}),(0,a.jsx)("button",{onClick:()=>k(e.versionNum),disabled:y,className:"px-3 py-1 text-sm text-white bg-blue-600 hover:bg-blue-700 rounded transition-colors disabled:opacity-50",children:"Vissza\xe1ll\xedt\xe1s"})]})]}),(null==d?void 0:d.id)===e.id&&(0,a.jsxs)("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Előn\xe9zet"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs font-medium text-gray-600",children:"C\xedm"}),(0,a.jsx)("p",{className:"text-sm text-gray-900 mt-1",children:e.title})]}),e.excerpt&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs font-medium text-gray-600",children:"Kivonat"}),(0,a.jsx)("p",{className:"text-sm text-gray-700 mt-1",children:e.excerpt})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs font-medium text-gray-600",children:"Tartalom"}),(0,a.jsx)("p",{className:"text-sm text-gray-700 mt-1 whitespace-pre-wrap",children:E(e.content)})]})]})]})]},e.id))})]}),m&&h.length>0&&(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:["\xd6sszehasonl\xedt\xe1s: v",m.versionNum," vs. Jelenlegi"]}),(0,a.jsx)("button",{onClick:()=>{x(null),g([])},className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[h.filter(e=>e.changed).map(e=>(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[(0,a.jsx)("div",{className:"bg-gray-50 px-4 py-2 border-b border-gray-200",children:(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-700",children:e.label})}),(0,a.jsxs)("div",{className:"grid grid-cols-2 divide-x divide-gray-200",children:[(0,a.jsxs)("div",{className:"p-4 bg-red-50",children:[(0,a.jsxs)("p",{className:"text-xs font-medium text-red-700 mb-2",children:["v",m.versionNum]}),(0,a.jsx)("div",{className:"text-sm text-gray-700 whitespace-pre-wrap max-h-96 overflow-y-auto",children:e.oldValue||(0,a.jsx)("span",{className:"text-gray-400 italic",children:"\xdcres"})})]}),(0,a.jsxs)("div",{className:"p-4 bg-green-50",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-green-700 mb-2",children:"Jelenlegi"}),(0,a.jsx)("div",{className:"text-sm text-gray-700 whitespace-pre-wrap max-h-96 overflow-y-auto",children:e.newValue||(0,a.jsx)("span",{className:"text-gray-400 italic",children:"\xdcres"})})]})]})]},e.field)),h.every(e=>!e.changed)&&(0,a.jsx)("p",{className:"text-center text-gray-500 py-4",children:"Nincs k\xfcl\xf6nbs\xe9g a verzi\xf3 \xe9s a jelenlegi \xe1llapot k\xf6z\xf6tt"})]})]})]})}}},e=>{e.O(0,[2619,4809,8441,1255,7358],()=>e(e.s=6064)),_N_E=e.O()}]);